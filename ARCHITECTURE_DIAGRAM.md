# AiTrend 精简架构图（最终版）

```
┌─────────────────────────────────────────────────────────────────────┐
│                         AiTrend 精简架构                              │
│                         代码宪法合规版                                │
├─────────────────────────────────────────────────────────────────────┤
│                                                                     │
│  ┌──────────────────────────────────────────────────────────────┐  │
│  │                       入口层                                  │  │
│  │  ┌──────────────────┐                                        │  │
│  │  │ src/__main__.py  │  <-- 项目入口                         │  │
│  │  └────────┬─────────┘                                        │  │
│  │           ↓                                                   │  │
│  │  ┌──────────────────┐                                        │  │
│  │  │ src/hourly.py    │  <-- 主运行逻辑（261行）               │  │
│  │  └────────┬─────────┘                                        │  │
│  └───────────┼──────────────────────────────────────────────────┘  │
│              │                                                     │
│              ↓                                                     │
│  ┌──────────────────────────────────────────────────────────────┐  │
│  │                  内容生成层（唯一）                            │  │
│  │                                                              │  │
│  │  ┌──────────────────────────────────────────────────────┐   │  │
│  │  │  src/llm_content_generator.py (143行) ✅ 宪法合规     │   │  │
│  │  │      - Gemini 2.5 Flash API                          │   │  │
│  │  │      - 自动生成独特内容                              │   │  │
│  │  │      - 拒绝模板化文字                                │   │  │
│  │  │      - 失败立即报错                                  │   │  │
│  │  └──────────────────────────────────────────────────────┘   │  │
│  └──────────────────────────────────────────────────────────────┘  │
│              │                                                     │
│              ↓                                                     │
│  ┌──────────────────────────────────────────────────────────────┐  │
│  │                    数据源层（6个源）                           │  │
│  │                                                              │  │
│  │  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐      │  │
│  │  │ github_trend │  │ producthunt  │  │ reddit       │      │  │
│  │  │ .py (165行)  │  │ .py (160行)  │  │ .py (117行)  │      │  │
│  │  └──────────────┘  └──────────────┘  └──────────────┘      │  │
│  │  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐      │  │
│  │  │ tavily       │  │ hackernews   │  │ twitter      │      │  │
│  │  │ .py (102行)  │  │ .py (134行)  │  │ .py (156行)  │      │  │
│  │  └──────────────┘  └──────────────┘  └──────────────┘      │  │
│  │  ┌──────────────┐                                           │  │
│  │  │ base.py (42行) │ <-- 数据源基类                           │  │
│  │  └──────────────┘                                           │  │
│  │  ┌──────────────┐                                           │  │
│  │  │ __init__.py  │ <-- 数据源工厂                             │  │
│  │  └──────────────┘                                           │  │
│  └──────────────────────────────────────────────────────────────┘  │
│              │                                                     │
│              ↓                                                     │
│  ┌──────────────────────────────────────────────────────────────┐  │
│  │                    核心服务层                                  │  │
│  │                                                              │  │
│  │  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐      │  │
│  │  │ config_loader│  │ deduplicator │  │ webhook_     │      │  │
│  │  │ .py (44行)   │  │ .py (116行)  │  │ sender.py    │      │  │
│  │  └──────────────┘  └──────────────┘  └──────────────┘      │  │
│  └──────────────────────────────────────────────────────────────┘  │
│              │                                                     │
│              ↓                                                     │
│  ┌──────────────────────────────────────────────────────────────┐  │
│  │                   发布渠道层                                   │  │
│  │                                                              │  │
│  │  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐      │  │
│  │  │ base.py      │  │ forum_       │  │ text_        │      │  │
│  │  │ (35行)       │  │ publisher.py │  │ publisher.py │      │  │
│  │  └──────────────┘  │ (103行)      │  │ (99行)       │      │  │
│  │                    └──────────────┘  └──────────────┘      │  │
│  │                                                              │  │
│  └──────────────────────────────────────────────────────────────┘  │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘

                         📊 统计信息
┌─────────────────────────────────────────────────────────────────────┐
│  总文件数: 15 个 Python 文件                                         │
│  总代码行: 1,679 行（精简后）                                         │
│  已删除: 2,925 行废弃代码                                             │
│  代码宪法: ✅ 完全合规                                                │
└─────────────────────────────────────────────────────────────────────┘

                         🗑️ 已删除文件
┌─────────────────────────────────────────────────────────────────────┐
│  ❌ src/auto_dtp.py              ❌ src/free_narrative.py          │
│  ❌ src/real_content_generator.py ❌ src/strict_dtp.py             │
│  ❌ src/core/sender.py           ❌ src/dtp_controller.py          │
│  ❌ src/quality_control.py       ❌ src/scrapers/                  │
│  ❌ src/analytics.py             ❌ src/utils/                     │
│  ❌ src/test_multi_source.py     ❌ src/core/__init__.py           │
└─────────────────────────────────────────────────────────────────────┘

                         ✅ 架构特点
┌─────────────────────────────────────────────────────────────────────┐
│  ✓ 单一内容生成源: 仅 llm_content_generator.py                       │
│  ✓ 无模板化代码: 所有内容通过 LLM 生成                               │
│  ✓ 无内容拼接: 通过 full_concat_check.sh 验证                        │
│  ✓ 模块化设计: 数据源、生成、发布三层分离                            │
│  ✓ 配置驱动: 支持环境变量覆盖                                        │
└─────────────────────────────────────────────────────────────────────┘

                         📁 文件清单
┌─────────────────────────────────────────────────────────────────────┐
│ 入口层:                                                              │
│   src/__main__.py, src/hourly.py                                    │
│                                                                     │
│ 内容生成层:                                                          │
│   src/llm_content_generator.py (唯一内容源)                          │
│                                                                     │
│ 数据源层:                                                            │
│   src/sources/base.py                                               │
│   src/sources/github_trending.py, producthunt.py, reddit.py         │
│   src/sources/tavily.py, hackernews.py, twitter.py                  │
│   src/sources/__init__.py                                           │
│                                                                     │
│ 核心服务层:                                                          │
│   src/core/config_loader.py, deduplicator.py, webhook_sender.py     │
│                                                                     │
│ 发布渠道层:                                                          │
│   publishers/base.py, forum_publisher.py, text_publisher.py         │
│   publishers/__init__.py                                            │
└─────────────────────────────────────────────────────────────────────┘

GitHub: https://github.com/Lychee-AI-Team/AiTrend
Commit: 81ad931
